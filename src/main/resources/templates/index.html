<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>게시판</title>
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="/css/velog.css" />
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/ko.js"></script>

    <style>
        body {
            background-image: url('/images/background.jpg'); /* 이미지 경로 */
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
            color: #222; /* 기본 글자색 (배경에 따라 조절 가능) */
            font-family: 'Segoe UI', sans-serif;
        }
        .custom-tooltip {
            position: fixed;
            background: rgba(0, 0, 0, 0.7);
            color: #fff;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            pointer-events: none;
            z-index: 9999;
        }
        .event-dot {
            display: inline-block;
            position: absolute;
            top: 4px;
            right: 4px;
            width: 10px;      /* 조금 크게 조정 가능 */
            height: 10px;
            border-radius: 50%;
        }
    </style>
</head>
<body>
<header>
    <nav>
        <div class="nav-container">
            <div class="nav-left"></div> <!-- 좌측 여백 -->
            <div class="logo">Auto Blog</div>
            <div class="nav-right nav-buttons">
                <button id="logout-btn" class="logout-btn">로그아웃</button>
                <img id="profile-icon" src="/images/default-profile.png" alt="프로필" class="profile-icon">
            </div>
        </div>
    </nav>
</header>
<div class="main-layout">
    <div class="sidebar">
        <div class="calendar-container">
            <h3>캘린더</h3>
            <div class="calendar">
                <input type="text" id="calendar-input" />
            </div>
        </div>

        <div class="links-container velog-popular">
            <h3 class="velog-title">🔥 Velog 실시간 인기글 🔥</h3>
            <ul class="links-list">
                <li th:each="post : ${velogPosts}" class="velog-post-item">
                    <a th:href="${post.link}" th:text="${post.title}" target="_blank"></a>
                </li>
            </ul>
        </div>
    </div>
    <div class="main-content-wrapper">
        <div class="tag-bar">
            <button class="tag tag-tag1">태그1</button>
            <button class="tag tag-tag2">태그2</button>
            <button class="tag tag-tag3">태그3</button>
            <button class="tag tag-tag4">태그4</button>
            <button class="tag tag-tag5">태그5</button>
            <button class="tag tag-tag6">태그6</button>
        </div>

        <div class="main-container">
            <h1>게시판</h1>
            <div class="header-container">
                <div id="search-container">
                    <input type="text" id="search-input"/>
                    <button id="search-btn">검색</button>
                </div>
                <button id="create-board-btn">글 작성</button>
            </div>

            <div id="board-list">
                <!-- 게시글 목록이 여기에 동적으로 추가됨 -->
            </div>

            <div id="pagination">
                <!-- 페이지네이션 버튼 -->
            </div>
        </div>
    </div>
</div>

<script>
    const categoryColors = {
        "자격증": "#A0C4FF",   // 파스텔 블루
        "세미나": "#FFB3AB",   // 파스텔 레드
        "해커톤": "#B9FBC0",   // 파스텔 그린
        "공모전": "#FFC6FF",   // 파스텔 핑크
        "박람회": "#FFE4B3",   // 파스텔 옐로우
        "워크숍": "#D0B3FF"    // 파스텔 퍼플
    };

    const events = {
      "2025-08-06": { title: "Oracle Dev Day", url: "https://onoffmix.com/event/326545?srsltid=AfmBOooSu8KHeEbVaDaZnSNEMlGRgjwGYh5NV4t7CY_InMCwuixJ3iFe", category: "세미나" },
      "2025-08-09": { title: "기사 제3회 필기시험 시작", url: "https://www.q-net.or.kr/man001.do?gSite=Q&gIntro=Y", category: "자격증" },
      "2025-08-10": { title: "UbuCon Korea 2025", url: "https://2025.ubuntu-kr.org/ko/", category: "박람회" },
      "2025-08-15": { title: "2025 네트워크 AI 해커톤 참가자 접수 마감", url: "https://aifactory.space/task/9159/overview", category: "해커톤" },
      "2025-08-21": { title: "노코드 Dify와 MCP로 구현하는 AI 에이전트 업무 자동화 1-day 워크숍", url: "https://conference.etnews.com/conf_info.html?uid=414", category: "워크숍" },
      "2025-08-23": { title: "FEConf 2025", url: "https://2025.feconf.kr/", category: "세미나" },
      "2025-08-31": { title: "기사 제3회 필기시험 마감", url: "https://www.q-net.or.kr/man001.do?gSite=Q&gIntro=Y", category: "자격증" }
    };

    flatpickr("#calendar-input", {
      inline: true,
      locale: "ko",
      dateFormat: "Y-m-d",

      onChange: function(selectedDates, dateStr) {
        if(events[dateStr]) {
          window.open(events[dateStr].url, "_blank");
        }
      },

      onDayCreate: function(dObj, dStr, fp, dayElem) {
        const localDate = dayElem.dateObj;
        const year = localDate.getFullYear();
        const month = String(localDate.getMonth() + 1).padStart(2, '0');
        const day = String(localDate.getDate()).padStart(2, '0');
        const dateKey = `${year}-${month}-${day}`;

        if(events[dateKey]) {
          dayElem.style.cursor = "pointer";

          // 작은 원 추가 (중복 방지)
          if (!dayElem.querySelector(".event-dot")) {
            const dot = document.createElement("span");
            dot.className = "event-dot";
            dot.style.backgroundColor = categoryColors[events[dateKey].category] || "#000";
            dayElem.style.position = "relative";
            dayElem.appendChild(dot);
          }

          if (!dayElem.hasTooltipEvents) {
            dayElem.hasTooltipEvents = true;

            let tooltip = null;

            dayElem.addEventListener("mouseenter", (e) => {
              const existingTooltip = document.querySelector(".custom-tooltip");
              if(existingTooltip) existingTooltip.remove();

              tooltip = document.createElement("div");
              tooltip.className = "custom-tooltip";
              tooltip.textContent = events[dateKey].title;

              // 날짜 바로 아래에 고정 위치
              const rect = dayElem.getBoundingClientRect();
              Object.assign(tooltip.style, {
                position: "fixed",
                top: `${rect.bottom + 5}px`,
                left: `${rect.left}px`,
                background: "rgba(0, 0, 0, 0.7)",
                color: "#fff",
                padding: "4px 8px",
                borderRadius: "4px",
                fontSize: "12px",
                pointerEvents: "none",
                zIndex: "9999"
              });

              document.body.appendChild(tooltip);
            });

            const removeTooltip = () => {
              if (tooltip) {
                tooltip.remove();
                tooltip = null;
              }
            };

            dayElem.addEventListener("mouseleave", () => {
              removeTooltip();
            });
          }
        }
      }
    });
</script>

<script src="/js/board.js"></script>
</body>
</html>
